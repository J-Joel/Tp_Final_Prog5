@using TP_Final_Programacion5.Areas.Act6.Controllers
@using TP_Final_Programacion5.Areas.Act6.Models
@model IEnumerable<Movie>
@{
    ViewData["Title"] = "Lista de peliculas";
}
@section CSS {
    <!-- CSS específico de esta vista -->
    <link rel="stylesheet" href="~/css/Act6/peli_index.css" />
}
<div class="conte-Text">
    <p>¡Hola, de momento se carga desde una base de datos local, mediante clases estaticas!</p>
    <table class="table">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Titulo)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.FechaPublicada)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Genero)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Precio)
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Titulo)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.FechaPublicada)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Genero)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Precio)
                    </td>
                    <td hidden>
                        <input type="radio" name="selectedUser" value="@item.Id" />
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
 @section PD{
    <div style="width:100%;height:100%;">
        <input type="radio" id="actionActivo" hidden />
        <ul class="panels-conte">
            <li>
                <a href="#">Añadir</a>
            </li>
            <li id="conteAction" class="conteAction">
                <ul class="panels-conte">
                    <li>
                        <a id="btnEditar" href="#">Editar</a>
                    </li>
                    <li>
                        <a id="btnDetalle" href="#">Detalle</a>
                    </li>
                    <li>
                        <a id="btnEliminar" href="#">Borrar</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div> 
}
@section Scripts {
    <script>
        $(document).ready(function () {
            // Capturamos los radio buttons de selección
            $('input[name="selectedUser"]').change(function () {
                var idUsuario = $(this).val(); // Obtenemos el ID del usuario seleccionado

                var urlDetalles = '@Url.Action("Detalles", "Peliculas", new { area = "Act6" })';

                $('#btnDetalle').attr('href', urlDetalles + '/' + idUsuario);
                //$('#btnEditar').attr('href', ulrModificar + '/' + selectedUserId);
                //$('#btnEliminar').attr('href', urlEliminar + '/' + selectedUserId);

                // Mostrar el div con los enlaces de acción
                $('#conteAction').css('display','flex');
                $('#actionActivo').prop('checked', true);
            });

            // Hace que la fila entera sea clickeable para seleccionar el radio button
            $('tbody tr').click(function() {
                 $(this).find('input[name="selectedUser"]').prop('checked', true).trigger('change');
            });
        });
    </script>
}